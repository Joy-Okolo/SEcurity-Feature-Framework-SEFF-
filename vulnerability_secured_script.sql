CREATE TABLE VulnerabilityDataset (
    id INT AUTO_INCREMENT PRIMARY KEY,
    language VARCHAR(50) NOT NULL,
    vulnerability_type VARCHAR(100) NOT NULL,
    seff_criteria VARCHAR(100) NOT NULL,
    label ENUM('vulnerable', 'secure') NOT NULL,
    code_sample TEXT NOT NULL
);

-- SQL Injection
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES 
('Python', 'SQL Injection', 'Input Validation', 'vulnerable', 'user_input = input("Enter username: ")\nquery = f"SELECT * FROM users WHERE username = \'{user_input}\'"\ncursor.execute(query)'),
('Python', 'SQL Injection', 'Input Validation', 'secure', 'user_input = input("Enter username: ")\nquery = "SELECT * FROM users WHERE username = %s"\ncursor.execute(query, (user_input,))');

-- Buffer Overflow
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES 
('Python', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'data = "A" * 1000\nprocess_input(data)'), 
('Python', 'Buffer Overflow', 'Memory Management', 'secure', 'data = "A" * 100\ndef process_input(input):\n    if len(input) < 500:\n        process_input(input)');

-- Cross-Site Scripting
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES
('Python', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'user_input = "<script>alert(1)</script>"\nprint(f"Output: {user_input}")'),
('Python', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'user_input = "<script>alert(1)</script>"\nprint(f"Output: {html.escape(user_input)}")');

-- Buffer Overflow
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES 
('C', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'void vulnerable_function() {\n    char buffer[10];\n    gets(buffer);\n}'),
('C', 'Buffer Overflow', 'Memory Management', 'secure', 'void secure_function() {\n    char buffer[10];\n    fgets(buffer, sizeof(buffer), stdin);\n}');

-- Heartbleed Bug
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES
('C', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'memcpy(buffer, user_input, user_input_length);'),
('C', 'Heartbleed Bug', 'Communication Security', 'secure', 'if (user_input_length <= sizeof(buffer)) {\n    memcpy(buffer, user_input, user_input_length);\n}');

-- ROP
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES
('C++', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'void vulnerable_function() {\n    int* ptr = (int*)0x400;\n    *ptr = 0;\n}'),
('C++', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'void secure_function() {\n    int safe_array[10];\n    int* ptr = safe_array;\n    *ptr = 0;\n}');

-- Race Conditions
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES
('C++', 'Race Conditions', 'Access Control', 'vulnerable', 'void update_counter() {\n    counter++;\n}'),
('C++', 'Race Conditions', 'Access Control', 'secure', 'void update_counter() {\n    std::lock_guard<std::mutex> lock(mutex);\n    counter++;\n}');

-- XSS
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES 
('Ruby', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'def display_user_input\n  user_input = params[:input]\n  render html: "User Input: #{user_input}".html_safe\nend'),
('Ruby', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'def display_user_input\n  user_input = params[:input]\n  render html: "User Input: #{CGI.escapeHTML(user_input)}"\nend');

-- Sensitive Data Exposure
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample)
VALUES
('Ruby', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'logger.error("Password: #{password}")'),
('Ruby', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'logger.error("Password: [FILTERED]")');


-- SQL Injection
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'SQL Injection', 'Input Validation', 'vulnerable', 'String query = "SELECT * FROM users WHERE username = \'" + input + "\'";\nstmt.execute(query);'),
('Java', 'SQL Injection', 'Input Validation', 'vulnerable', 'String query = "DELETE FROM accounts WHERE id=" + inputId;\nstmt.execute(query);'),
('Java', 'SQL Injection', 'Input Validation', 'secure', 'String query = "SELECT * FROM users WHERE username = ?";\nPreparedStatement pstmt = conn.prepareStatement(query);\npstmt.setString(1, username);\npstmt.execute();'),
('Java', 'SQL Injection', 'Input Validation', 'secure', 'String query = "DELETE FROM accounts WHERE id = ?";\nPreparedStatement pstmt = conn.prepareStatement(query);\npstmt.setInt(1, accountId);\npstmt.execute();');

-- Buffer Overflow
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'byte[] buffer = new byte[1024];\nSystem.arraycopy(input, 0, buffer, 0, input.length);'),
('Java', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'byte[] data = new byte[2048];\ndata[2049] = 1;  // Overflow'),
('Java', 'Buffer Overflow', 'Memory Management', 'secure', 'byte[] buffer = new byte[1024];\nif (input.length <= buffer.length) {\n    System.arraycopy(input, 0, buffer, 0, input.length);\n}'),
('Java', 'Buffer Overflow', 'Memory Management', 'secure', 'try {\n    byte[] buffer = new byte[1024];\n    System.arraycopy(input, 0, buffer, 0, input.length);\n} catch (ArrayIndexOutOfBoundsException e) {\n    System.err.println("Buffer Overflow Prevented");\n}');

-- Return-Oriented Programming (ROP)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'public void vulnerableMethod() {\n    Runtime.getRuntime().exec("rm -rf /");\n}'),
('Java', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'public void vulnerableExec() {\n    Process p = Runtime.getRuntime().exec(userInput);\n}'),
('Java', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'public void secureExec() {\n    if (isValidCommand(userInput)) {\n        ProcessBuilder pb = new ProcessBuilder(userInput);\n        pb.start();\n    }\n}'),
('Java', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'public void safeExec() {\n    String sanitizedInput = sanitizeCommand(userInput);\n    ProcessBuilder pb = new ProcessBuilder(sanitizedInput);\n    pb.start();\n}');

-- Cross-Site Scripting (XSS)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'out.println("<script>alert(\'XSS\');</script>");'),
('Java', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'response.getWriter().write("<div>" + userInput + "</div>");'),
('Java', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'response.getWriter().write(escapeHtml(userInput));'),
('Java', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'out.println("<div>" + StringEscapeUtils.escapeHtml4(userInput) + "</div>");');

-- Time-of-Check to Time-of-Use (TOCTOU) Bugs
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if (!file.exists()) {\n    file.createNewFile();\n}'),
('Java', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if (user.hasAccess()) {\n    performAction();\n}'),
('Java', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'synchronized (fileLock) {\n    if (!file.exists()) {\n        file.createNewFile();\n    }\n}'),
('Java', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'if (isAuthorized(user)) {\n    synchronized (accessLock) {\n        performAction();\n    }\n}');

-- Sensitive Data Exposure
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'logger.info("User password: " + password);'),
('Java', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'System.out.println("SSN: " + ssn);'),
('Java', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'logger.info("User password: [REDACTED]");'),
('Java', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'System.out.println("SSN: [HIDDEN]");');

-- Broken Authentication
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if (username.equals("admin")) {\n    accessGranted = true;\n}'),
('Java', 'Broken Authentication', 'Communication Security', 'vulnerable', 'String token = request.getParameter("token");\nif (token.equals(storedToken)) {\n    session.setAuthenticated(true);\n}'),
('Java', 'Broken Authentication', 'Communication Security', 'secure', 'if (validateCredentials(username, password)) {\n    grantAccess();\n}'),
('Java', 'Broken Authentication', 'Communication Security', 'secure', 'String secureToken = generateSecureToken();\nsession.setToken(secureToken);');

-- Race Conditions
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Race Conditions', 'Access Control', 'vulnerable', 'if (!file.exists()) {\n    file.createNewFile();\n}'),
('Java', 'Race Conditions', 'Access Control', 'vulnerable', 'if (account.getBalance() >= withdrawalAmount) {\n    account.withdraw(withdrawalAmount);\n}'),
('Java', 'Race Conditions', 'Access Control', 'secure', 'synchronized (fileLock) {\n    if (!file.exists()) {\n        file.createNewFile();\n    }\n}'),
('Java', 'Race Conditions', 'Access Control', 'secure', 'synchronized (accountLock) {\n    if (account.getBalance() >= withdrawalAmount) {\n        account.withdraw(withdrawalAmount);\n    }\n}');

-- Heartbleed Bug
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'byte[] buffer = new byte[messageLength];\ninput.read(buffer);'),
('Java', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'byte[] data = new byte[length];\nsocket.read(data, 0, length);'),
('Java', 'Heartbleed Bug', 'Communication Security', 'secure', 'if (messageLength <= buffer.length) {\n    input.read(buffer);\n}'),
('Java', 'Heartbleed Bug', 'Communication Security', 'secure', 'if (length <= maxLength) {\n    socket.read(data, 0, length);\n}');

-- Man-in-the-Middle (MITM) Attacks
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Java', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'SSLContext sc = SSLContext.getInstance("TLS");\nsc.init(null, new TrustManager[] { new InsecureTrustManager() }, null);'),
('Java', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'Socket socket = new Socket("example.com", 443);\nsocket.startHandshake();'),
('Java', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'SSLContext sc = SSLContext.getInstance("TLS");\nsc.init(null, new TrustManager[] { new DefaultTrustManager() }, null);'),
('Java', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'Socket socket = new Socket("example.com", 443);\nSSLParameters sslParams = socket.getSSLParameters();\nsslParams.setEndpointIdentificationAlgorithm("HTTPS");');

-- SQL Injection
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'SQL Injection', 'Input Validation', 'vulnerable', 'query = f"SELECT * FROM users WHERE username = \'{username}\'";\ncursor.execute(query)'),
('Python', 'SQL Injection', 'Input Validation', 'vulnerable', 'query = "DELETE FROM accounts WHERE id=" + user_id;\ncursor.execute(query);'),
('Python', 'SQL Injection', 'Input Validation', 'secure', 'query = "SELECT * FROM users WHERE username = %s";\ncursor.execute(query, (username,))'),
('Python', 'SQL Injection', 'Input Validation', 'secure', 'query = "DELETE FROM accounts WHERE id = %s";\ncursor.execute(query, (account_id,))');

-- Buffer Overflow
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'data = "A" * 4096\nprocess_input(data)'),
('Python', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'payload = "B" * 8192\nsend_data(payload)'),
('Python', 'Buffer Overflow', 'Memory Management', 'secure', 'data = "A" * 100\nif len(data) <= 1024:\n    process_input(data)'),
('Python', 'Buffer Overflow', 'Memory Management', 'secure', 'payload = "B" * 512\nif len(payload) <= 1024:\n    send_data(payload)');

-- Return-Oriented Programming (ROP)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'import os\nos.system(user_input)'),
('Python', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'exec(user_input)'),
('Python', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'import subprocess\nsubprocess.run(sanitize_input(user_input), shell=False)'),
('Python', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'if validate_input(user_input):\n    execute_command(user_input)');

-- Cross-Site Scripting (XSS)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'html = f"<div>{user_input}</div>"'),
('Python', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'output = "<script>" + user_input + "</script>"'),
('Python', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'import html\nsafe_html = html.escape(user_input)'),
('Python', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'output = "<div>" + escape_html(user_input) + "</div>"');

-- Time-of-Check to Time-of-Use (TOCTOU) Bugs
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if not os.path.exists(file_path):\n    open(file_path, "w")'),
('Python', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if user_has_access(user):\n    delete_file(file_path)'),
('Python', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'with file_lock:\n    if not os.path.exists(file_path):\n        open(file_path, "w")'),
('Python', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'if validate_access(user):\n    with access_lock:\n        delete_file(file_path)');

-- Sensitive Data Exposure
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'print(f"User password: {password}")'),
('Python', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'log.info(f"Credit Card Number: {cc_number}")'),
('Python', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'print("User password: [REDACTED]")'),
('Python', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'log.info("Credit Card Number: [HIDDEN]")');

-- Broken Authentication
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if user == "admin":\n    grant_access()'),
('Python', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if token == stored_token:\n    session.authenticated = True'),
('Python', 'Broken Authentication', 'Communication Security', 'secure', 'if validate_credentials(user, password):\n    grant_access()'),
('Python', 'Broken Authentication', 'Communication Security', 'secure', 'session.token = generate_secure_token()');

-- Race Conditions
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Race Conditions', 'Access Control', 'vulnerable', 'if not os.path.exists(file_path):\n    open(file_path, "w")'),
('Python', 'Race Conditions', 'Access Control', 'vulnerable', 'if account.balance >= withdrawal_amount:\n    account.withdraw(withdrawal_amount)'),
('Python', 'Race Conditions', 'Access Control', 'secure', 'with file_lock:\n    if not os.path.exists(file_path):\n        open(file_path, "w")'),
('Python', 'Race Conditions', 'Access Control', 'secure', 'with account_lock:\n    if account.balance >= withdrawal_amount:\n        account.withdraw(withdrawal_amount)');

-- Heartbleed Bug
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'data = socket.recv(length)'),
('Python', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'buffer = stream.read(message_length)'),
('Python', 'Heartbleed Bug', 'Communication Security', 'secure', 'if length <= MAX_BUFFER:\n    data = socket.recv(length)'),
('Python', 'Heartbleed Bug', 'Communication Security', 'secure', 'if message_length <= MAX_BUFFER:\n    buffer = stream.read(message_length)');

-- Man-in-the-Middle (MITM) Attacks
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Python', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'ssl.wrap_socket(socket, cert_reqs=ssl.CERT_NONE)'),
('Python', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'socket = create_insecure_socket("example.com", 443)'),
('Python', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'ssl.wrap_socket(socket, cert_reqs=ssl.CERT_REQUIRED)'),
('Python', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'socket = create_secure_socket("example.com", 443)');

-- SQL Injection
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'SQL Injection', 'Input Validation', 'vulnerable', 'sprintf(query, "SELECT * FROM users WHERE username = \'%s\'", user_input);\nsql_execute(query);'),
('C', 'SQL Injection', 'Input Validation', 'vulnerable', 'sprintf(query, "DELETE FROM accounts WHERE id=%s", input_id);\nsql_execute(query);'),
('C', 'SQL Injection', 'Input Validation', 'secure', 'snprintf(query, sizeof(query), "SELECT * FROM users WHERE username = ?");\nsql_bind_param(query, user_input);\nsql_execute(query);'),
('C', 'SQL Injection', 'Input Validation', 'secure', 'snprintf(query, sizeof(query), "DELETE FROM accounts WHERE id = ?");\nsql_bind_param(query, account_id);\nsql_execute(query);');

-- Buffer Overflow
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'char buffer[10];\nstrcpy(buffer, input);'),
('C', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'char buffer[5];\nsprintf(buffer, "%s", input);'),
('C', 'Buffer Overflow', 'Memory Management', 'secure', 'char buffer[10];\nstrncpy(buffer, input, sizeof(buffer) - 1);\nbuffer[sizeof(buffer) - 1] = \'\\0\';'),
('C', 'Buffer Overflow', 'Memory Management', 'secure', 'char buffer[5];\nsnprintf(buffer, sizeof(buffer), "%s", input);');

-- Return-Oriented Programming (ROP)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'system(user_input);'),
('C', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'execvp(args[0], args);'),
('C', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'if (validate_command(user_input)) {\n    system(sanitized_input);\n}'),
('C', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'execvp("safe_program", args);');

-- Cross-Site Scripting (XSS)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'sprintf(buffer, "<div>%s</div>", user_input);'),
('C', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'printf("<script>%s</script>", user_input);'),
('C', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'snprintf(buffer, sizeof(buffer), "<div>%s</div>", sanitize_input(user_input));'),
('C', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'printf("<div>%s</div>", escape_html(user_input));');

-- Time-of-Check to Time-of-Use (TOCTOU) Bugs
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if (access(file_path, W_OK) == 0) {\n    open(file_path, O_WRONLY);\n}'),
('C', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if (user_has_access(user)) {\n    unlink(file_path);\n}'),
('C', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'pthread_mutex_lock(&file_lock);\nif (access(file_path, W_OK) == 0) {\n    open(file_path, O_WRONLY);\n}\npthread_mutex_unlock(&file_lock);'),
('C', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'if (validate_access(user)) {\n    pthread_mutex_lock(&access_lock);\n    unlink(file_path);\n    pthread_mutex_unlock(&access_lock);\n}');

-- Sensitive Data Exposure
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'printf("User password: %s\\n", password);'),
('C', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'fprintf(stderr, "Credit Card: %s\\n", cc_number);'),
('C', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'printf("User password: [REDACTED]\\n");'),
('C', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'fprintf(stderr, "Credit Card: [HIDDEN]\\n");');

-- Broken Authentication
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if (strcmp(user, "admin") == 0) {\n    grant_access();\n}'),
('C', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if (strcmp(token, stored_token) == 0) {\n    session.authenticated = 1;\n}'),
('C', 'Broken Authentication', 'Communication Security', 'secure', 'if (validate_credentials(user, password)) {\n    grant_access();\n}'),
('C', 'Broken Authentication', 'Communication Security', 'secure', 'char *secure_token = generate_secure_token();\nsession.token = secure_token;');

-- Race Conditions
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Race Conditions', 'Access Control', 'vulnerable', 'if (access(file_path, W_OK) == 0) {\n    open(file_path, O_WRONLY);\n}'),
('C', 'Race Conditions', 'Access Control', 'vulnerable', 'if (account.balance >= withdrawal_amount) {\n    account.withdraw(withdrawal_amount);\n}'),
('C', 'Race Conditions', 'Access Control', 'secure', 'pthread_mutex_lock(&file_lock);\nif (access(file_path, W_OK) == 0) {\n    open(file_path, O_WRONLY);\n}\npthread_mutex_unlock(&file_lock);'),
('C', 'Race Conditions', 'Access Control', 'secure', 'pthread_mutex_lock(&account_lock);\nif (account.balance >= withdrawal_amount) {\n    account.withdraw(withdrawal_amount);\n}\npthread_mutex_unlock(&account_lock);');

-- Heartbleed Bug
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'memcpy(buffer, input, length);'),
('C', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'read(sock, buffer, message_length);'),
('C', 'Heartbleed Bug', 'Communication Security', 'secure', 'if (length <= sizeof(buffer)) {\n    memcpy(buffer, input, length);\n}'),
('C', 'Heartbleed Bug', 'Communication Security', 'secure', 'if (message_length <= sizeof(buffer)) {\n    read(sock, buffer, message_length);\n}');

-- Man-in-the-Middle (MITM) Attacks
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'SSL_CTX_set_verify(ctx, SSL_VERIFY_NONE, NULL);'),
('C', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'SSL_CTX_use_certificate_file(ctx, "insecure_cert.pem", SSL_FILETYPE_PEM);'),
('C', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'SSL_CTX_set_verify(ctx, SSL_VERIFY_PEER, verify_callback);'),
('C', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'SSL_CTX_use_certificate_file(ctx, "secure_cert.pem", SSL_FILETYPE_PEM);');

-- SQL Injection
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'SQL Injection', 'Input Validation', 'vulnerable', 'std::string query = "SELECT * FROM users WHERE username = \'" + userInput + "\';";\ndb.execute(query);'),
('C++', 'SQL Injection', 'Input Validation', 'vulnerable', 'std::string query = "DELETE FROM accounts WHERE id=" + userId;\ndb.execute(query);'),
('C++', 'SQL Injection', 'Input Validation', 'secure', 'std::string query = "SELECT * FROM users WHERE username = ?";\ndb.prepare(query).bind(userInput).execute();'),
('C++', 'SQL Injection', 'Input Validation', 'secure', 'std::string query = "DELETE FROM accounts WHERE id = ?";\ndb.prepare(query).bind(userId).execute();');

-- Buffer Overflow
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'char buffer[10];\nstrcpy(buffer, input.c_str());'),
('C++', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'char array[5];\nsprintf(array, "%s", input.c_str());'),
('C++', 'Buffer Overflow', 'Memory Management', 'secure', 'char buffer[10];\nstrncpy(buffer, input.c_str(), sizeof(buffer) - 1);\nbuffer[sizeof(buffer) - 1] = \'\\0\';'),
('C++', 'Buffer Overflow', 'Memory Management', 'secure', 'std::array<char, 5> buffer;\nsnprintf(buffer.data(), buffer.size(), "%s", input.c_str());');

-- Cross-Site Scripting (XSS)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'std::cout << "<div>" << userInput << "</div>";'),
('C++', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'std::printf("<script>%s</script>", userInput.c_str());'),
('C++', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'std::cout << "<div>" << escapeHtml(userInput) << "</div>";'),
('C++', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'std::printf("<div>%s</div>", escapeHtml(userInput).c_str());');

-- Time-of-Check to Time-of-Use (TOCTOU) Bugs
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if (!std::filesystem::exists(filePath)) {\n    std::ofstream(filePath);\n}'),
('C++', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if (user.hasAccess()) {\n    performAction();\n}'),
('C++', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'std::lock_guard<std::mutex> lock(fileMutex);\nif (!std::filesystem::exists(filePath)) {\n    std::ofstream(filePath);\n}'),
('C++', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'if (user.isAuthorized()) {\n    std::lock_guard<std::mutex> lock(accessMutex);\n    performAction();\n}');

-- Sensitive Data Exposure
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'std::cerr << "Password: " << password << std::endl;'),
('C++', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'std::printf("SSN: %s\\n", ssn.c_str());'),
('C++', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'std::cerr << "Password: [REDACTED]" << std::endl;'),
('C++', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'std::printf("SSN: [HIDDEN]\\n");');

-- Broken Authentication
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if (userInput == "admin") {\n    grantAccess();\n}'),
('C++', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if (token == storedToken) {\n    session.setAuthenticated(true);\n}'),
('C++', 'Broken Authentication', 'Communication Security', 'secure', 'if (validateCredentials(username, password)) {\n    grantAccess();\n}'),
('C++', 'Broken Authentication', 'Communication Security', 'secure', 'std::string secureToken = generateSecureToken();\nsession.setToken(secureToken);');

-- Race Conditions
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Race Conditions', 'Access Control', 'vulnerable', 'if (balance >= withdrawalAmount) {\n    balance -= withdrawalAmount;\n}'),
('C++', 'Race Conditions', 'Access Control', 'vulnerable', 'if (!std::filesystem::exists(filePath)) {\n    std::ofstream(filePath);\n}'),
('C++', 'Race Conditions', 'Access Control', 'secure', 'std::lock_guard<std::mutex> lock(accountMutex);\nif (balance >= withdrawalAmount) {\n    balance -= withdrawalAmount;\n}'),
('C++', 'Race Conditions', 'Access Control', 'secure', 'std::lock_guard<std::mutex> lock(fileMutex);\nif (!std::filesystem::exists(filePath)) {\n    std::ofstream(filePath);\n}');

-- Heartbleed Bug
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'std::memcpy(buffer, input, length);'),
('C++', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'socket.read(buffer, messageLength);'),
('C++', 'Heartbleed Bug', 'Communication Security', 'secure', 'if (length <= sizeof(buffer)) {\n    std::memcpy(buffer, input, length);\n}'),
('C++', 'Heartbleed Bug', 'Communication Security', 'secure', 'if (messageLength <= sizeof(buffer)) {\n    socket.read(buffer, messageLength);\n}');

-- Man-in-the-Middle (MITM) Attacks
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'SSL_CTX_set_verify(ctx, SSL_VERIFY_NONE, NULL);'),
('C++', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'SSL_CTX_use_certificate_file(ctx, "insecure.pem", SSL_FILETYPE_PEM);'),
('C++', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'SSL_CTX_set_verify(ctx, SSL_VERIFY_PEER, verify_callback);'),
('C++', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'SSL_CTX_use_certificate_file(ctx, "secure.pem", SSL_FILETYPE_PEM);');

-- Return-Oriented Programming (ROP)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'std::system(userInput.c_str());'),
('C++', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'std::execvp(args[0], args);'),
('C++', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'if (isValidCommand(userInput)) {\n    std::system(sanitizedInput.c_str());\n}'),
('C++', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'std::execvp("safe_program", args);');

-- Cross-Site Scripting (XSS)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('C++', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'std::cout << "<div>" << userInput << "</div>";'),
('C++', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'std::printf("<script>%s</script>", userInput.c_str());'),
('C++', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'std::cout << "<div>" << escapeHtml(userInput) << "</div>";'),
('C++', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'std::printf("<div>%s</div>", escapeHtml(userInput).c_str());');

-- SQL Injection
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'SQL Injection', 'Input Validation', 'vulnerable', 'User.where("username = \'#{params[:username]}\'").first'),
('Ruby', 'SQL Injection', 'Input Validation', 'vulnerable', 'Account.delete_by_sql("DELETE FROM accounts WHERE id=" + params[:id])'),
('Ruby', 'SQL Injection', 'Input Validation', 'secure', 'User.find_by(username: params[:username])'),
('Ruby', 'SQL Injection', 'Input Validation', 'secure', 'Account.where(id: params[:id]).delete_all');

-- Buffer Overflow
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'buffer = "A" * 5000\nprocess(buffer)'),
('Ruby', 'Buffer Overflow', 'Memory Management', 'vulnerable', 'payload = "B" * 8192\nsend(payload)'),
('Ruby', 'Buffer Overflow', 'Memory Management', 'secure', 'buffer = "A" * 512\nif buffer.length <= 1024\n    process(buffer)\nend'),
('Ruby', 'Buffer Overflow', 'Memory Management', 'secure', 'payload = "B" * 256\nsend(payload) if payload.length <= 1024');

-- Return-Oriented Programming (ROP)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'system(params[:cmd])'),
('Ruby', 'Return-Oriented Programming (ROP)', 'Memory Management', 'vulnerable', 'eval(params[:code])'),
('Ruby', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'if valid_command?(params[:cmd])\n    exec(params[:cmd])\nend'),
('Ruby', 'Return-Oriented Programming (ROP)', 'Memory Management', 'secure', 'sanitized_code = sanitize(params[:code])\neval(sanitized_code)');

-- Cross-Site Scripting (XSS)
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'html = "<div>#{params[:user_input]}</div>"'),
('Ruby', 'Cross-Site Scripting (XSS)', 'Input Validation', 'vulnerable', 'output = "<script>#{params[:input]}</script>"'),
('Ruby', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'html = "<div>#{CGI.escapeHTML(params[:user_input])}</div>"'),
('Ruby', 'Cross-Site Scripting (XSS)', 'Input Validation', 'secure', 'output = "<div>#{sanitize(params[:input])}</div>"');

-- Time-of-Check to Time-of-Use (TOCTOU) Bugs
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if !File.exist?(file_path)\n  File.new(file_path, "w")\nend'),
('Ruby', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'vulnerable', 'if user.has_access?\n  perform_action\nend'),
('Ruby', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'File.open(file_path, File::CREAT|File::EXCL) do |file|\n  file.write("data")\nend'),
('Ruby', 'Time-of-Check to Time-of-Use (TOCTOU) Bugs', 'Access Control', 'secure', 'if user.authorized?\n  lock.synchronize do\n    perform_action\n  end\nend');

-- Sensitive Data Exposure
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'puts "User password: #{password}"'),
('Ruby', 'Sensitive Data Exposure', 'Error Handling', 'vulnerable', 'logger.error("SSN: #{params[:ssn]}")'),
('Ruby', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'puts "User password: [REDACTED]"'),
('Ruby', 'Sensitive Data Exposure', 'Error Handling', 'secure', 'logger.error("SSN: [HIDDEN]")');

-- Broken Authentication
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if params[:user] == "admin"\n  grant_access\nend'),
('Ruby', 'Broken Authentication', 'Communication Security', 'vulnerable', 'if params[:token] == stored_token\n  session[:authenticated] = true\nend'),
('Ruby', 'Broken Authentication', 'Communication Security', 'secure', 'if validate_credentials(params[:user], params[:password])\n  grant_access\nend'),
('Ruby', 'Broken Authentication', 'Communication Security', 'secure', 'session[:token] = generate_secure_token');

-- Race Conditions
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Race Conditions', 'Access Control', 'vulnerable', 'if !File.exist?(file_path)\n  File.new(file_path, "w")\nend'),
('Ruby', 'Race Conditions', 'Access Control', 'vulnerable', 'if account.balance >= withdrawal_amount\n  account.withdraw(withdrawal_amount)\nend'),
('Ruby', 'Race Conditions', 'Access Control', 'secure', 'lock.synchronize do\n  if !File.exist?(file_path)\n    File.new(file_path, "w")\n  end\nend'),
('Ruby', 'Race Conditions', 'Access Control', 'secure', 'lock.synchronize do\n  if account.balance >= withdrawal_amount\n    account.withdraw(withdrawal_amount)\n  end\nend');

-- Heartbleed Bug
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'buffer = socket.read(message_length)'),
('Ruby', 'Heartbleed Bug', 'Communication Security', 'vulnerable', 'data = socket.recv(length)'),
('Ruby', 'Heartbleed Bug', 'Communication Security', 'secure', 'if message_length <= MAX_BUFFER\n  buffer = socket.read(message_length)\nend'),
('Ruby', 'Heartbleed Bug', 'Communication Security', 'secure', 'if length <= MAX_BUFFER\n  data = socket.recv(length)\nend');

-- Man-in-the-Middle (MITM) Attacks
INSERT INTO VulnerabilityDataset (language, vulnerability_type, seff_criteria, label, code_sample) VALUES
('Ruby', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'ssl_context = OpenSSL::SSL::SSLContext.new\nssl_context.verify_mode = OpenSSL::SSL::VERIFY_NONE'),
('Ruby', 'Man-in-the-Middle (MITM)', 'Communication Security', 'vulnerable', 'socket = TCPSocket.new("example.com", 443)\nsocket.start_ssl'),
('Ruby', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'ssl_context = OpenSSL::SSL::SSLContext.new\nssl_context.verify_mode = OpenSSL::SSL::VERIFY_PEER'),
('Ruby', 'Man-in-the-Middle (MITM)', 'Communication Security', 'secure', 'socket = TCPSocket.new("example.com", 443)\nsocket.start_ssl(ssl_context)');


select * from VulnerabilityDataset;